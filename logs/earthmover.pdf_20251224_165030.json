[
  {
    "message": "{'total_page_number': 12}",
    "level": "INFO",
    "timestamp": "2025-12-24T16:50:31.250000"
  },
  {
    "message": "{'total_token': 74351}",
    "level": "INFO",
    "timestamp": "2025-12-24T16:50:31.283000"
  },
  {
    "message": "{'toc_content': 'and every calculation is still conducted at its entirety. In our study,\\nwe observe that it is possible to incrementally derive and tighten\\narunning lower bound for the EMD during the SIA calculation.\\nBased on this, we introduce a progressive bounding (PB) technique,\\nwhich can terminate the SIA calculations early for histograms that\\nare no longer promising to the similarity query. In addition, we\\npropose a dynamic reﬁnement ordering (DRO) technique, which\\nconcurrently handles and dynamically re-orders multiple EMD cal-\\nculations. These two techniques greatly reduce the computations at\\nthe reﬁnement phase of EMD-based similarity search, boosting the\\nsearch performance.\\nPB and DRO can be seamlessly integrated with any existing (and\\nfuture) ﬁltering techniques. We show by experimentation that our\\ntechniques can compute EMD-based similarity queries one to two\\norders of magnitude faster, compared to the current state-of-the-\\nart [25]. To the best of our knowledge, ours is the ﬁrst study on\\nthis subject that considers datasets of million-scale on the object\\ncardinality and thousand-scale on the histogram dimensionality.\\nThe rest of the paper is organized as follows. Section 2 formally\\ndeﬁnes EMD, presents a min-cost ﬂow algorithm for its compu-\\ntation, and discusses the standard ﬁlter-and-reﬁnement framework\\nused for EMD-based similarity queries. Section 3 describes SIA, an\\noptimized implementation of the successive shortest path MCF al-\\ngorithm. Section 4 presents our progressive bounding and dynamic\\nreﬁnement ordering techniques. Section 5 includes an extensive ex-\\nperimental evaluation which demonstrates the effectiveness of our\\ntechniques. Related work is presented in Section 6. Finally, Sec-\\ntion 7 concludes the paper with a discussion about future work.\\n2. PRELIMINARIES\\nTheEarth Mover’s Distance (EMD), ﬁrst introduced by the com-\\nputer vision community in [23,24], is a distance function that mea-\\nsures the dissimilarity of two histograms (e.g., probability or fea-\\nture distributions). Given two histograms q= (q 1;:::;q n)and\\np= (p 1;:::;p n), each having nbins, a ﬂow matrix F, wherefi;j\\nindicates ﬂow (i.e., earth) to move from qitopj, and a cost matrix\\nC, whereci;jmodels cost of moving ﬂow from the i-th bin to the\\nj-th bin, we can deﬁne the total cost of moving unit ﬂow according\\ntoFandCbetween qandpas\\nd(q;p) =nX\\ni=1nX\\nj=1fi;jci;j (1)\\nThe cost matrix (a.k.a., ground distance) Ccan be designed by\\ndomain experts and/or derived from a mathematical formula [25,\\n32]. Intuitively, ci;i= 0 and the larger the distance between iand\\njin the bin space, the larger ci;jis.3Assuming that qandpare\\nnormalized such thatPn\\ni=1qi=Pn\\ni=1pi, the EMD between q\\nandpis formally deﬁned as follows:\\nemd(q; p) = min\\nFd(q;p);\\nsuch that8i;j2[1;n] :fi;j\\x150;\\n8i2[1;n] :nX\\nj=1fi;j=qi;\\nand8j2[1;n] :nX\\ni=1fi;j=pj (2)\\n3The motivating example of [32] partitions a 2-dimensional feature\\nspace (humidity and temperature) into 4\\x024 cells based on the range\\nof domain values. The cost ci;jbetween bins iandjis represented\\nby their Euclidean distance of the corresponding cells.emd(q; p)is the minimum cost needed to transform qtop; to\\ndo so, we distribute the ﬂow (i.e., earth) from each bin qito a set\\nof initially empty bins for p, such that the resulting histogram will\\nbe equal to p. As moving earth fi;jfromqito thej-th bin of\\npbears a costfi;jci;j, the objective is to ﬁnd the ﬂow distribution\\nthat results in the minimum total cost. Note that emd(q; p)is equal\\ntoemd(p; q)when the cost matrix Cis symmetric.\\nWe demonstrate the calculation and applicability of EMD via a\\nreal example from web data analysis. Figure 1(a) and 1(b) illustrate\\nthe download rates of four music genres by two customers, qand\\np, in an online store. The rates are normalized such that all values\\nof each histogram sum to 10. To calculate the distance emd(q;p)\\nbetween the two customers, we should identify the minimum work\\nto transform genre distribution qto distribution p. Assume that the\\ncost matrix Cof the music genres is as shown in Table 1, where\\nindices 1,2,3,4denote the four music genres (i.e., R&B, Samba,\\nJazz, and House, respectively). Figure 1(c) illustrates the best trans-\\nformation of qtopin terms of the total cost among all feasible\\ntransformations. For instance, there are 3 units in q’sR&B genre.\\nIn the transformation, f1;1= 2 units are moved to p’sR&B (with\\ncost2\\x01c1;1= 0) andf1;3= 1unit is moved to p’sJazz (with cost\\n1\\x01c1;3= 0:1). Thus, based on the best transformation, emd(q;p)\\nis0:1+2:4+0+0 = 2 :5, providing a quantitative measure for the\\ndissimilarity between these two customers. This example demon-\\nstrates an application of EMD to viral marketing analysis, which\\nenables enterprises to derive similarities between customers in or-\\nder to promote their products.\\n4\\n2\\n13Download rates\\nR&B House SambaJazz\\n(a)q’s distribution\\nDownload rates\\n14\\n3\\n2\\nR&\\nBHouse SambaJazz (b)p’s distribution\\nDownload rates\\nR&B House SambaJazz (c)emd(q; p)\\nFigure 1: A concrete example of online music library analysis\\nTable 1: Cost matrix Cof 4 music genres\\np1p2p3p4\\nq1 0 0.9 0.1 0.7\\nq2 0.9 0 0.6 0.9\\nq3 0.1 0.6 0 0.3\\nq4 0.7 0.9 0.3 0\\nq1\\nq2\\nq3\\nq4p1\\np2\\np3\\np43\\n4\\n2\\n12\\n1\\n4\\n3q p\\n(a) Flow graph\\n2/2\\n1/11/3q p\\n1/1p1\\np2\\np40\\n0\\n0\\n000\\n00\\n1/4\\np32/3\\n2/2q1\\nq4q2\\nq3 (b) Min-cost ﬂow\\n2/2\\n1/10\\n0\\n0\\n1q p\\n1\\n0\\n0\\n02/21/1\\n2/40/3\\n1/3q1\\nq2\\nq3\\nq4p1\\np2\\np3\\np4 (c) Feasible path\\nFigure 2: The ﬂow network of the music example\\n 314', 'toc_page_list': [1], 'page_index_given_in_toc': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-24T16:51:21.447000"
  },
  {
    "message": "len(group_texts): 3",
    "level": "INFO",
    "timestamp": "2025-12-24T16:51:21.480000"
  }
]