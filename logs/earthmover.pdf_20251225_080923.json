[
  {
    "message": "{'total_page_number': 12}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:09:24.695000"
  },
  {
    "message": "{'total_token': 74351}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:09:24.725000"
  },
  {
    "message": "{'toc_content': 'and every calculation is still conducted at its entirety. In our study,\\nwe observe that it is possible to incrementally derive and tighten\\narunning lower bound for the EMD during the SIA calculation.\\nBased on this, we introduce a progressive bounding (PB) technique,\\nwhich can terminate the SIA calculations early for histograms that\\nare no longer promising to the similarity query. In addition, we\\npropose a dynamic reﬁnement ordering (DRO) technique, which\\nconcurrently handles and dynamically re-orders multiple EMD cal-\\nculations. These two techniques greatly reduce the computations at\\nthe reﬁnement phase of EMD-based similarity search, boosting the\\nsearch performance.\\nPB and DRO can be seamlessly integrated with any existing (and\\nfuture) ﬁltering techniques. We show by experimentation that our\\ntechniques can compute EMD-based similarity queries one to two\\norders of magnitude faster, compared to the current state-of-the-\\nart [25]. To the best of our knowledge, ours is the ﬁrst study on\\nthis subject that considers datasets of million-scale on the object\\ncardinality and thousand-scale on the histogram dimensionality.\\nThe rest of the paper is organized as follows. Section 2 formally\\ndeﬁnes EMD, presents a min-cost ﬂow algorithm for its compu-\\ntation, and discusses the standard ﬁlter-and-reﬁnement framework\\nused for EMD-based similarity queries. Section 3 describes SIA, an\\noptimized implementation of the successive shortest path MCF al-\\ngorithm. Section 4 presents our progressive bounding and dynamic\\nreﬁnement ordering techniques. Section 5 includes an extensive ex-\\nperimental evaluation which demonstrates the effectiveness of our\\ntechniques. Related work is presented in Section 6. Finally, Sec-\\ntion 7 concludes the paper with a discussion about future work.\\n2. PRELIMINARIES\\nTheEarth Mover’s Distance (EMD), ﬁrst introduced by the com-\\nputer vision community in [23,24], is a distance function that mea-\\nsures the dissimilarity of two histograms (e.g., probability or fea-\\nture distributions). Given two histograms q= (q 1;:::;q n)and\\np= (p 1;:::;p n), each having nbins, a ﬂow matrix F, wherefi;j\\nindicates ﬂow (i.e., earth) to move from qitopj, and a cost matrix\\nC, whereci;jmodels cost of moving ﬂow from the i-th bin to the\\nj-th bin, we can deﬁne the total cost of moving unit ﬂow according\\ntoFandCbetween qandpas\\nd(q;p) =nX\\ni=1nX\\nj=1fi;jci;j (1)\\nThe cost matrix (a.k.a., ground distance) Ccan be designed by\\ndomain experts and/or derived from a mathematical formula [25,\\n32]. Intuitively, ci;i= 0 and the larger the distance between iand\\njin the bin space, the larger ci;jis.3Assuming that qandpare\\nnormalized such thatPn\\ni=1qi=Pn\\ni=1pi, the EMD between q\\nandpis formally deﬁned as follows:\\nemd(q; p) = min\\nFd(q;p);\\nsuch that8i;j2[1;n] :fi;j\\x150;\\n8i2[1;n] :nX\\nj=1fi;j=qi;\\nand8j2[1;n] :nX\\ni=1fi;j=pj (2)\\n3The motivating example of [32] partitions a 2-dimensional feature\\nspace (humidity and temperature) into 4\\x024 cells based on the range\\nof domain values. The cost ci;jbetween bins iandjis represented\\nby their Euclidean distance of the corresponding cells.emd(q; p)is the minimum cost needed to transform qtop; to\\ndo so, we distribute the ﬂow (i.e., earth) from each bin qito a set\\nof initially empty bins for p, such that the resulting histogram will\\nbe equal to p. As moving earth fi;jfromqito thej-th bin of\\npbears a costfi;jci;j, the objective is to ﬁnd the ﬂow distribution\\nthat results in the minimum total cost. Note that emd(q; p)is equal\\ntoemd(p; q)when the cost matrix Cis symmetric.\\nWe demonstrate the calculation and applicability of EMD via a\\nreal example from web data analysis. Figure 1(a) and 1(b) illustrate\\nthe download rates of four music genres by two customers, qand\\np, in an online store. The rates are normalized such that all values\\nof each histogram sum to 10. To calculate the distance emd(q;p)\\nbetween the two customers, we should identify the minimum work\\nto transform genre distribution qto distribution p. Assume that the\\ncost matrix Cof the music genres is as shown in Table 1, where\\nindices 1,2,3,4denote the four music genres (i.e., R&B, Samba,\\nJazz, and House, respectively). Figure 1(c) illustrates the best trans-\\nformation of qtopin terms of the total cost among all feasible\\ntransformations. For instance, there are 3 units in q’sR&B genre.\\nIn the transformation, f1;1= 2 units are moved to p’sR&B (with\\ncost2\\x01c1;1= 0) andf1;3= 1unit is moved to p’sJazz (with cost\\n1\\x01c1;3= 0:1). Thus, based on the best transformation, emd(q;p)\\nis0:1+2:4+0+0 = 2 :5, providing a quantitative measure for the\\ndissimilarity between these two customers. This example demon-\\nstrates an application of EMD to viral marketing analysis, which\\nenables enterprises to derive similarities between customers in or-\\nder to promote their products.\\n4\\n2\\n13Download rates\\nR&B House SambaJazz\\n(a)q’s distribution\\nDownload rates\\n14\\n3\\n2\\nR&\\nBHouse SambaJazz (b)p’s distribution\\nDownload rates\\nR&B House SambaJazz (c)emd(q; p)\\nFigure 1: A concrete example of online music library analysis\\nTable 1: Cost matrix Cof 4 music genres\\np1p2p3p4\\nq1 0 0.9 0.1 0.7\\nq2 0.9 0 0.6 0.9\\nq3 0.1 0.6 0 0.3\\nq4 0.7 0.9 0.3 0\\nq1\\nq2\\nq3\\nq4p1\\np2\\np3\\np43\\n4\\n2\\n12\\n1\\n4\\n3q p\\n(a) Flow graph\\n2/2\\n1/11/3q p\\n1/1p1\\np2\\np40\\n0\\n0\\n000\\n00\\n1/4\\np32/3\\n2/2q1\\nq4q2\\nq3 (b) Min-cost ﬂow\\n2/2\\n1/10\\n0\\n0\\n1q p\\n1\\n0\\n0\\n02/21/1\\n2/40/3\\n1/3q1\\nq2\\nq3\\nq4p1\\np2\\np3\\np4 (c) Feasible path\\nFigure 2: The ﬂow network of the music example\\n 314', 'toc_page_list': [1], 'page_index_given_in_toc': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:09:58.691000"
  },
  {
    "message": "len(group_texts): 3",
    "level": "INFO",
    "timestamp": "2025-12-25T08:09:58.718000"
  },
  {
    "message": "generate_toc: [{'structure': '1', 'title': 'Earth Mover’s Distance based Similarity Search at Scale', 'physical_index': '<physical_index_1>'}, {'structure': '1.1', 'title': 'INTRODUCTION', 'physical_index': '<physical_index_1>'}, {'structure': '2', 'title': 'PRELIMINARIES', 'physical_index': '<physical_index_2>'}, {'structure': '2.1', 'title': 'Computing the EMD', 'physical_index': '<physical_index_3>'}, {'structure': '2.2', 'title': 'Filter-and-Reﬁnement Framework', 'physical_index': '<physical_index_3>'}, {'structure': '3', 'title': 'SCALING UP SSP', 'physical_index': '<physical_index_4>'}, {'structure': '4', 'title': 'BOOSTING THE REFINEMENT PHASE', 'physical_index': '<physical_index_5>'}, {'structure': '4.1', 'title': 'Analysis of EMD Calculation', 'physical_index': '<physical_index_5>'}, {'structure': '4.2', 'title': 'Progressive Bounding', 'physical_index': '<physical_index_5>'}, {'structure': '4.3', 'title': 'Sensitivity to Reﬁnement Order', 'physical_index': '<physical_index_6>'}, {'structure': '4.4', 'title': 'Dynamic Reﬁnement Ordering', 'physical_index': '<physical_index_7>'}, {'structure': '4.5', 'title': 'Running Upper Bound', 'physical_index': '<physical_index_8>'}, {'structure': '5', 'title': 'EXPERIMENTAL EVALUATION', 'physical_index': '<physical_index_9>'}, {'structure': '5.1', 'title': 'Performance Improvement', 'physical_index': '<physical_index_9>'}, {'structure': '5.2', 'title': 'Scalability Experiments', 'physical_index': '<physical_index_10>'}, {'structure': '5.3', 'title': 'Parameter Tuning in DRO', 'physical_index': '<physical_index_11>'}, {'structure': '6', 'title': 'RELATED WORK', 'physical_index': '<physical_index_12>'}, {'structure': '7', 'title': 'CONCLUSION', 'physical_index': '<physical_index_12>'}, {'structure': '8', 'title': 'ACKNOWLEDGMENT', 'physical_index': '<physical_index_12>'}, {'structure': '9', 'title': 'REFERENCES', 'physical_index': '<physical_index_12>'}]",
    "level": "INFO",
    "timestamp": "2025-12-25T08:11:24.835000"
  },
  {
    "message": "convert_physical_index_to_int: [{'structure': '1', 'title': 'Earth Mover’s Distance based Similarity Search at Scale', 'physical_index': 1}, {'structure': '1.1', 'title': 'INTRODUCTION', 'physical_index': 1}, {'structure': '2', 'title': 'PRELIMINARIES', 'physical_index': 2}, {'structure': '2.1', 'title': 'Computing the EMD', 'physical_index': 3}, {'structure': '2.2', 'title': 'Filter-and-Reﬁnement Framework', 'physical_index': 3}, {'structure': '3', 'title': 'SCALING UP SSP', 'physical_index': 4}, {'structure': '4', 'title': 'BOOSTING THE REFINEMENT PHASE', 'physical_index': 5}, {'structure': '4.1', 'title': 'Analysis of EMD Calculation', 'physical_index': 5}, {'structure': '4.2', 'title': 'Progressive Bounding', 'physical_index': 5}, {'structure': '4.3', 'title': 'Sensitivity to Reﬁnement Order', 'physical_index': 6}, {'structure': '4.4', 'title': 'Dynamic Reﬁnement Ordering', 'physical_index': 7}, {'structure': '4.5', 'title': 'Running Upper Bound', 'physical_index': 8}, {'structure': '5', 'title': 'EXPERIMENTAL EVALUATION', 'physical_index': 9}, {'structure': '5.1', 'title': 'Performance Improvement', 'physical_index': 9}, {'structure': '5.2', 'title': 'Scalability Experiments', 'physical_index': 10}, {'structure': '5.3', 'title': 'Parameter Tuning in DRO', 'physical_index': 11}, {'structure': '6', 'title': 'RELATED WORK', 'physical_index': 12}, {'structure': '7', 'title': 'CONCLUSION', 'physical_index': 12}, {'structure': '8', 'title': 'ACKNOWLEDGMENT', 'physical_index': 12}, {'structure': '9', 'title': 'REFERENCES', 'physical_index': 12}]",
    "level": "INFO",
    "timestamp": "2025-12-25T08:11:24.864000"
  },
  {
    "message": "{'mode': 'process_toc_with_page_numbers', 'accuracy': 0.95, 'incorrect_results': [{'list_index': 16, 'answer': 'no', 'title': 'RELATED WORK', 'page_number': 12}]}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:11:52.093000"
  },
  {
    "message": "incorrect_results_and_range_logs: [{'list_index': 16, 'title': 'RELATED WORK', 'prev_correct': 11, 'next_correct': 12}]",
    "level": "INFO",
    "timestamp": "2025-12-25T08:11:58.933000"
  },
  {
    "message": "invalid_results: []",
    "level": "INFO",
    "timestamp": "2025-12-25T08:11:58.966000"
  },
  {
    "message": "Checking title appearance in start concurrently",
    "level": "INFO",
    "timestamp": "2025-12-25T08:11:58.993000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'INTRODUCTION' appears in the page_text, but it is not the first content. The page_text starts with a title, authors, affiliations, and an 'ABSTRACT' section before reaching the 'INTRODUCTION' section.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:08.815000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Computing the EMD' is found at the very beginning of the page_text, ignoring the '2.1' prefix and any space inconsistencies. Therefore, the section starts at the beginning of the page_text.\", 'start_begin': 'yes'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:08.945000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'BOOSTING THE REFINEMENT PHASE' appears in the page_text, but it is not at the beginning. There is a significant amount of content, including figures and text, before the section title is mentioned.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:09.070000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Earth Mover’s Distance based Similarity Search at Scale' appears at the very beginning of the page_text, with no other content preceding it. The title is followed by the authors' names and affiliations, which are part of the section content.\", 'start_begin': 'yes'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:10.776000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'PRELIMINARIES' appears in the page_text, but it is not at the beginning. There is a significant amount of text before the section title '2. PRELIMINARIES' is mentioned. Therefore, the section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:12.210000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'SCALING UP SSP' appears in the page_text, but it is not at the beginning. The page_text starts with 'Algorithm 1 FILTER -AND -REFINEMENT FOR k-NN' and contains several paragraphs before the section title 'SCALING UP SSP' is introduced.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:12.331000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Analysis of EMD Calculation' does not appear at the beginning of the page_text. The page_text starts with various numerical and alphanumeric sequences, followed by a figure caption and other content. The section title appears later in the text, indicating that the section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:13.514000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Filter-and-Reﬁnement Framework' appears in the page_text, but it is not the first content. The page_text starts with '2.1 Computing the EMD' and other content before the section title '2.2 Filter-and-Reﬁnement Framework' is encountered. Therefore, the section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:14.772000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Dynamic Reﬁnement Ordering' appears in the page_text, but it is not at the beginning. The page_text starts with other content and the section title appears later in the text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:18.691000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Running Upper Bound' appears in the page_text, but it is preceded by a significant amount of content. The section title is found towards the end of the provided page_text, indicating that it does not start at the beginning.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:20.859000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Progressive Bounding' does not appear at the beginning of the page_text. The page_text starts with various numerical and alphanumeric sequences, and the section title 'Progressive Bounding' appears later in the text. Therefore, the section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:22.127000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Sensitivity to Reﬁnement Order' does not appear at the beginning of the page_text. Instead, the page_text starts with content related to 'current cost' and 'EMD calculations'. The section title appears later in the text, indicating that the section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:22.933000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Performance Improvement' appears in the page_text, but it is not at the beginning. The page_text starts with 'Table 3: The statistics of six real datasets' and other content before the section title 'Performance Improvement' is encountered.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:23.163000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Parameter Tuning in DRO' does not appear at the beginning of the page_text. The page_text starts with numerical values and dataset-related information, and the section title appears later in the text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:24.055000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'Scalability Experiments' appears in the page_text, but it is not at the beginning. The section starts after a significant amount of content, including figures and descriptions of other experiments. Therefore, the section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:24.398000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'EXPERIMENTAL EVALUATION' does not appear at the beginning of the page_text. Instead, the page_text starts with 'Table 3: The statistics of six real datasets', which is unrelated to the section title. Therefore, the section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:25.049000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'CONCLUSION' appears in the page_text, but it is not at the beginning. There is a significant amount of text before the 'CONCLUSION' section starts.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:28.176000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'RELATED WORK' does not appear at the beginning of the page_text. Instead, the page_text starts with content unrelated to the section title, such as 'For example, the choice of ground distance could be application-dependent'. Therefore, the section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:29.727000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'ACKNOWLEDGMENT' appears in the page_text, but it is preceded by other content such as the 'CONCLUSION' section and additional text. Therefore, the 'ACKNOWLEDGMENT' section does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:30.949000"
  },
  {
    "message": "Response: {'thinking': \"The section title 'REFERENCES' appears in the page_text, but it is preceded by other content such as '7. CONCLUSION' and '8. ACKNOWLEDGMENT'. Therefore, the section 'REFERENCES' does not start at the beginning of the page_text.\", 'start_begin': 'no'}",
    "level": "INFO",
    "timestamp": "2025-12-25T08:12:31.066000"
  }
]